<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.2.1/css/bootstrap.min.css">
  <title>線上減重班 - 登入</title>
  <style>
    body {
      height: 85vh;
      background-color: #E9B2BD;
      font-family: 'Verdana', 'Hiragino Sans', 'Meiryo', sans-serif;
    }

    header {
      padding: 2vw;
    }

    h1,
    h2 {
      margin: 1vh auto;
      font-size: 5vh;
      color: purple;
      letter-spacing: 2vw;
    }

    form {
      display: flex;
      /* 垂直置中 */
      align-items: center;
      flex-direction: column;
      height: 30vh;
      width: auto;
      margin: 1vh;
    }

    label,
    button {
      font-size: 3vh;
    }

    label {
      color: #404040;
      letter-spacing: 1vw;
    }

    small {
      font-size: 2vh;
    }

    input {
      font-size: 3vh;
      padding: 1.5vh 3vh;
      border-radius: 1vh;
    }

    button {
      position: center;
      padding: 3vh;
    }

    .btn-primary {
      padding: 20px 35px;
      border-radius: 15px;
      font-size: 3vh;
    }

    footer {
      display: flex;
      /* 水平置中 */
      justify-content: center;
      height: 1vh;
      color: #b7b7b7;
      margin-top: 5vh;
    }
    
    /* 增加一個錯誤訊息的樣式 */
    #error-msg {
      color: red;
      font-size: 2vh;
      margin-top: 1vh;
      display: none;
    }
  </style>
</head>

<body>
  <header>
    <h1 class="text-center">線上減重班</h1>
    <h2 class="text-center">簽到查詢</h2>
  </header>
  <main>
    <form id="loginForm">
      <label for="id">手機號碼:</label>
      <input type="text" id="id" name="id" placeholder="請輸入手機號碼" required="required">
      <small class="form-text text-muted">例：0912345678</small>
      <button type="submit" id="submitBtn" class="btn btn-primary">查詢</button>
      <div id="error-msg"></div>
    </form>
  </main>
  <footer>
    <p>Copyright © 2023 Artemis線上減重班. All rights reserved.</p>
  </footer>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>
  
  <script type="text/javascript">
    // ==========================================
    // 請在這裡填入你 GAS 部署後的 Web App URL
    // 例如: "https://script.google.com/macros/s/AKfycbx.../exec"
    // ==========================================
    const GAS_URL = "https://script.google.com/macros/s/AKfycbxE5Wrqr_uPvuHZ6HhE6s3fWfh9j7QX5et4ANiI5SXXcH0_HS9ZL8OUon2B-Jrmd3eA/exec"; 

    document.getElementById('loginForm').addEventListener('submit', function(e) {
      e.preventDefault(); // 阻止表單預設跳頁行為
      
      const submitBtn = document.getElementById('submitBtn');
      const errorMsg = document.getElementById('error-msg');
      const idInput = document.getElementById('id').value.trim();

      // 簡單防呆
      if(!GAS_URL || GAS_URL.includes("https://script.google.com/macros/s/AKfycbxE5Wrqr_uPvuHZ6HhE6s3fWfh9j7QX5et4ANiI5SXXcH0_HS9ZL8OUon2B-Jrmd3eA/exec")) {
        alert("請先在 index.html 程式碼中設定 GAS_URL！");
        return;
      }

      // UI 鎖定
      submitBtn.setAttribute('disabled', true);
      submitBtn.innerText = "查詢中...";
      errorMsg.style.display = 'none';

      // 呼叫 GAS API
      fetch(`${GAS_URL}?op=checkLogin&id=${
